<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Handwriting Relationship Analyzer (Preview & Download PDF)</title>
  <!-- jsPDF & html2canvas CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link rel="stylesheet" href="relation_individual.css">
  <style>
    
  </style>
</head>
<body>
  <div class="app">
    <!-- LEFT PANEL: FORM CONTROLS -->
    <div class="panel">
      <h2>Relationship Analyzer</h2>

      <!-- User info -->
      <div class="form-section">
        <label for="userName">Full Name</label>
        <input id="userName" type="text" value="Sarah Johnson" />

        <label for="userAge">Age</label>
        <input id="userAge" type="number" value="28" min="1" max="120" />

        <label for="reportDate">Analysis Date</label>
        <input id="reportDate" type="text" readonly /> 
        <!-- <input id="reportDate" type="text" value="September 13, 2025" /> -->

        <label for="reportId">Report ID</label>
        <input id="reportId" type="text" value="REL-2025-001" />

      </div>

      <!-- Image uploads -->
      <div class="form-section">
        <h3 class="small">Handwriting Samples</h3>
        <label>Upload Signature</label>
        <input id="uploadSignature" type="file" accept="image/*" />
        <div id="signaturePreview" class="muted" style="margin-top:8px">No signature uploaded</div>

        <label style="margin-top:10px">Upload Handwriting Sample</label>
        <input id="uploadHandwriting" type="file" accept="image/*" />
        <div id="handwritingPreview" class="muted" style="margin-top:8px">No handwriting uploaded</div>
      </div>


      <!-- Emotional Handling -->
<div class="form-section">
    <h3 class="small">Emotional Handling Analysis</h3>
    <label>Select observed traits (multiple allowed)</label>
    
    <div id="emotionalSelect" style="border: 1px solid #d1d5db; border-radius: 6px; padding: 10px; background: white; max-height: 120px; overflow-y: auto;">
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="emotional-1" value="emotional-1" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="emotional-1" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Circular and Big dot over "i" or "j" - Emotional, high mood swings
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="emotional-2" value="emotional-2" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="emotional-2" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Mixed circular and small dots - Balanced emotional expression
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="emotional-3" value="emotional-3" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="emotional-3" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Small dots over "i" or "j" - Practical, handles emotions well
        </label>
      </div>
    </div>
    <textarea id="emotional_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea>


  </div>
  
  <!-- Communication Style -->
  <div class="form-section">
    <h3 class="small">Communication Style Analysis</h3>
    <label>Select communication indicators</label>
    
    <div id="communicationSelect" style="border: 1px solid #d1d5db; border-radius: 6px; padding: 10px; background: white; max-height: 150px; overflow-y: auto;">
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="comm-1" value="comm-1" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="comm-1" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Simple and closed "o" or "a" - Extrovert, expressive
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="comm-2" value="comm-2" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="comm-2" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Big handwriting - Confident and expressive
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="comm-3" value="comm-3" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="comm-3" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Mixed "o" or "a" - Adaptable communication
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="comm-4" value="comm-4" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="comm-4" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Small cut "o" or "a" - Introvert, keeps things inside
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="comm-5" value="comm-5" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="comm-5" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Small handwriting - Shares less, introvert
        </label>
      </div>
    </div>
    <textarea id="communication_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea>

  </div>
  
  <!-- Conflict Resolution -->
  <div class="form-section">
    <h3 class="small">Conflict Resolution Style</h3>
    <label>Select conflict handling patterns</label>
    
    <div id="conflictSelect" style="border: 1px solid #d1d5db; border-radius: 6px; padding: 10px; background: white; max-height: 180px; overflow-y: auto;">
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="conflict-1" value="conflict-1" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="conflict-1" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Simple small letter "p" - Healthy conflict handling
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="conflict-2" value="conflict-2" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="conflict-2" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Rounded handwriting - Peaceful approach
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="conflict-3" value="conflict-3" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="conflict-3" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Pointed first letter in signature - Gets angry easily
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="conflict-4" value="conflict-4" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="conflict-4" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Upper fluff of "e" - Open to feedback
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="conflict-5" value="conflict-5" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="conflict-5" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Pugilistic "p" - Relationship conflicts
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="conflict-6" value="conflict-6" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="conflict-6" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Pointed handwriting - Aggressive tendencies
        </label>
      </div>
    </div>
    <textarea id="conflict_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea>

  </div>
  
  <!-- Intimacy -->
  <div class="form-section">
    <h3 class="small">Physical/Intimacy Analysis</h3>
    <label>Select intimacy indicators</label>
    
    <div id="intimacySelect" style="border: 1px solid #d1d5db; border-radius: 6px; padding: 10px; background: white; max-height: 120px; overflow-y: auto;">
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="intimacy-1" value="intimacy-1" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="intimacy-1" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Elongated "g" or "y" - High intimacy needs
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="intimacy-2" value="intimacy-2" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="intimacy-2" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Consistent lower loops - Balanced intimacy
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="intimacy-3" value="intimacy-3" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="intimacy-3" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Small/open "g" or "y" - Lower intimacy needs
        </label>
      </div>
    </div>
    <textarea id="intimacy_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea>

  </div>
  
  <!-- Family Dynamics -->
  <div class="form-section">
    <h3 class="small">Family Dynamics</h3>
    <label>Select family-related patterns</label>
    
    <div id="familySelect" style="border: 1px solid #d1d5db; border-radius: 6px; padding: 10px; background: white; max-height: 180px; overflow-y: auto;">
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="family-1" value="family-1" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="family-1" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Only surname in signature - Strong family identity
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="family-2" value="family-2" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="family-2" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Surname bigger than name - Family dominates decisions
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="family-3" value="family-3" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="family-3" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Surname before name - Family-first mentality
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="family-4" value="family-4" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="family-4" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Balanced name and surname - Harmony
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="family-5" value="family-5" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="family-5" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Only name in signature - Independent identity
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="family-6" value="family-6" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="family-6" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Name clashing surname - Family-personal conflict
        </label>
      </div>
    </div>
    <textarea id="family_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea>

  </div>
  
  <!-- Financial Handling -->
  <div class="form-section">
    <h3 class="small">Financial Handling</h3>
    <label>Select financial patterns</label>
    
    <div id="financialSelect" style="border: 1px solid #d1d5db; border-radius: 6px; padding: 10px; background: white; max-height: 120px; overflow-y: auto;">
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="financial-1" value="financial-1" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="financial-1" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Open ended "j" - Impulsive spender
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="financial-2" value="financial-2" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="financial-2" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Mixed variations - Balanced approach
        </label>
      </div>
      
      <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding: 5px; border-radius: 4px; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#f9fafb'" onmouseout="this.style.backgroundColor='transparent'">
        <input type="checkbox" id="financial-3" value="financial-3" style="margin-right: 8px; margin-top: 2px; cursor: pointer;">
        <label for="financial-3" style="cursor: pointer; margin: 0; font-weight: normal; line-height: 1.4; flex: 1;">
          Closed "j" - Good at saving
        </label>
      </div>
    </div>
    <textarea id="financial_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea>

  </div>



      <!-- Overall Assessment -->
      <div class="form-section">
        <h3 class="small">Overall Relationship Assessment</h3>
        <label>Relationship Strengths</label>
        <textarea id="relationshipStrengths">Strong communication skills and emotional balance make this person a reliable and understanding partner.</textarea>
        
        <label style="margin-top:10px">Areas for Growth</label>
        <textarea id="areasForGrowth">Working on conflict resolution strategies could enhance relationship harmony.</textarea>
        
        <label style="margin-top:10px">Compatibility Summary</label>
        <textarea id="compatibilitySummary">Best suited for partners who appreciate open communication and emotional stability.</textarea>
      </div>

      <!-- Controls -->
      <div class="controls-row">
        <button id="applyBtn" class="btn btn-primary">Apply to Preview</button>
        <button id="previewPdf" class="btn btn-ghost">Preview PDF</button>
        <button id="downloadHtml" class="btn btn-primary">Export as HTML</button>
        <button id="resetBtn" class="btn btn-ghost">Reset</button>
      </div>

      <hr style="margin:14px 0" />
      
    </div>

    <!-- RIGHT PANEL: Preview -->
    <div class="panel preview-area">
      <div id="reportRoot" class="report-wrap">
        <!-- Header -->
        <div class="header">
          <h1>Graphological Relationship Analysis Report</h1>
          <p>Professional Personality & Compatibility Assessment</p>
        </div>

        <!-- Client Info -->
        <div class="client-info">
          <h2>Individual Information</h2>
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">Name:</span>
              <span id="r_name">Sarah Johnson</span>
            </div>
            <div class="info-item">
              <span class="info-label">Age:</span>
              <span id="r_age">28</span>
            </div>
            <div class="info-item">
              <span class="info-label">Analysis Date:</span>
              <span id="r_date">September 13, 2025</span>
            </div>
          </div>
          <div style="margin-top:10px">
            <span class="info-label">Report ID:</span>
            <span id="r_id">REL-2025-001</span>
          </div>
        </div>

        <!-- Section 1: Handwriting Samples -->
        <div class="section">
          <h2 class="section-title">1. Handwriting Analysis Samples</h2>
          
          <h3>Signature Analysis</h3>
          <div id="r_signatureBox" class="image-box">
            <img id="r_signature_img" class="report-img" src="" alt="Signature" style="display:none;" />
            <div id="r_signature_placeholder">No signature uploaded</div>
          </div>

          <h3>Handwriting Sample</h3>
          <div id="r_handwritingBox" class="image-box">
            <img id="r_handwriting_img" class="report-img" src="" alt="Handwriting" style="display:none;" />
            <div id="r_handwriting_placeholder">No handwriting sample uploaded</div>
          </div>
        </div>

     
        <!-- Section 2: Core Relationship Traits -->
        <div class="section">
          <h2 class="section-title">3. Core Relationship Traits Analysis</h2>

          <div class="trait-analysis-grid">
            <div class="trait-card">
              <h3>Emotional Handling</h3>
              <div style = "margin-bottom: 10px"></div>
              <label style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Datapoints:</label>

              <ul id="r_emotional_list" class="trait-list">
                <li>Select traits to see analysis</li>
              </ul>
              <h6 style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Analysis Notes:</h6>
              <!-- <textarea id="r_emotional_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea> -->
              <p id="r_emotional_text">Working on conflict resolution strategies could enhance relationship harmony.</p>

            </div>

            <div class="trait-card">
              <h3>Communication Style</h3>
              <div style = "margin-bottom: 10px"></div>
              <label style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Datapoints:</label>

              <ul id="r_communication_list" class="trait-list">
                <li>Select traits to see analysis</li>
              </ul>
              <h6 style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Analysis Notes:</h6>
              <!-- <textarea id="r_communication_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea> -->
              <p id="r_communication_text">Working on conflict resolution strategies could enhance relationship harmony.</p>


            </div>

            <div class="trait-card">
              <h3>Conflict Resolution</h3>
              <div style = "margin-bottom: 10px"></div>
              <label style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Datapoints:</label>

              <ul id="r_conflict_list" class="trait-list">
                <li>Select traits to see analysis</li>
              </ul>
              <h6 style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Analysis Notes:</h6>
              <!-- <textarea id="r_conflict_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea> -->
              <p id="r_conflict_text">Working on conflict resolution strategies could enhance relationship harmony.</p>

            </div>

            <div class="trait-card">
              <h3>Intimacy Needs</h3>
              <div style = "margin-bottom: 10px"></div>
              <label style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Datapoints:</label>

              <ul id="r_intimacy_list" class="trait-list">
                <li>Select traits to see analysis</li>
              </ul>
              <h6 style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Analysis Notes:</h6>
              <!-- <textarea id="r_intimacy_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea> -->
              <p id="r_intimacy_text">Working on conflict resolution strategies could enhance relationship harmony.</p>

            </div>

            <div class="trait-card">
              <h3>Family Dynamics</h3>
              <div style = "margin-bottom: 10px"></div>
              <label style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Datapoints:</label>

              <ul id="r_family_list" class="trait-list">
                <li>Select traits to see analysis</li>
              </ul>
              <h6 style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Analysis Notes:</h6>
              <!-- <textarea id="r_family_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea> -->
              <p id="r_family_text">Working on conflict resolution strategies could enhance relationship harmony.</p>

            </div>

            <div class="trait-card">
              <h3>Financial Approach</h3>
              <div style = "margin-bottom: 10px"></div>
              <label style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Datapoints:</label>

              <ul id="r_financial_list" class="trait-list">
                <li>Select traits to see analysis</li>
              </ul>
              <h6 style="margin: 15px 0 5px 0; font-size: 12px; color: #7f8c8d; font-weight: 600; text-transform: uppercase;">Analysis Notes:</h6>
              <!-- <textarea id="r_financial_text" placeholder="Enter your analysis or observations here..." style="width: 100%; height: 80px; padding: 8px; border: 1px solid #bdc3c7; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; background: #fafafa;"></textarea> -->
              <p id="r_financial_text">Working on conflict resolution strategies could enhance relationship harmony.</p>

            </div>
          </div>
        </div>

        <!-- Section 3: Compatibility Analysis -->
        <div class="section">
          <h2 class="section-title">4. Relationship Compatibility Analysis</h2>

          <div class="compatibility-section">
            <div class="compatibility-card compatible-card">
              <h4>✅ Compatible Partner Types</h4>
              <ul id="r_compatible_list" class="compatibility-list">
                <li>Select traits to generate compatibility analysis</li>
              </ul>
            </div>

            <div class="compatibility-card incompatible-card">
              <h4>⚠️ Potentially Challenging Matches</h4>
              <ul id="r_incompatible_list" class="compatibility-list">
                <li>Select traits to generate compatibility analysis</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Section 4: Professional Assessment -->
        <div class="section">
          <h2 class="section-title">5. Professional Relationship Assessment</h2>

          <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; border-left: 4px solid #ffc300;">
            <h3 style="color: #1a1a1a; margin-bottom: 15px;">Relationship Strengths</h3>
            <p id="r_strengths">Strong communication skills and emotional balance make this person a reliable and understanding partner.</p>
          </div>

          <div style="background: #fff7ed; padding: 25px; border-radius: 15px; border-left: 4px solid #f59e0b; margin-top: 20px;">
            <h3 style="color: #1a1a1a; margin-bottom: 15px;">Areas for Growth</h3>
            <p id="r_growth">Working on conflict resolution strategies could enhance relationship harmony.</p>
          </div>

          <div style="background: #ede9fe; padding: 25px; border-radius: 15px; border-left: 4px solid #ffc300; margin-top: 20px;">
            <h3 style="color: #1a1a1a; margin-bottom: 15px;">Compatibility Summary for <span id="r_compat_name">Sarah Johnson</span></h3>
            <p id="r_compatibility">Best suited for partners who appreciate open communication and emotional stability.</p>
          </div>
        </div>

        <div class="footer">
          <p>&copy; 2025 Professional Handwriting Analysis Services. All rights reserved.</p>
          <p>This confidential report is prepared exclusively for <span id="r_footer_name">Sarah Johnson</span></p>
        </div>
      </div>
    </div>
  </div>

  <script src="relation_individual.js"></script>
  <script>
document.addEventListener("DOMContentLoaded", () => {
  document.getElementById("downloadHtml").addEventListener("click", async () => {
    const previewArea = document.querySelector(".preview-area");

    // 1️⃣ Grab all CSS from current page
    const styles = Array.from(document.styleSheets)
      .map(ss => {
        try {
          return Array.from(ss.cssRules).map(rule => rule.cssText).join('');
        } catch {
          return '';
        }
      })
      .join('');

    // 2️⃣ Clone preview and compress images to base64 JPEG
    const clone = previewArea.cloneNode(true);
    const images = clone.querySelectorAll("img");
    for (const img of images) {
      try {
        const dataUrl = await toCompressedDataURL(img.src, 0.7); // 70% quality
        img.src = dataUrl;
      } catch (e) {
        console.warn("Could not inline image", img.src, e);
      }
    }

    // 3️⃣ Build full HTML with styles AND a print button
    const htmlContent = `
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Relationship Analysis Snapshot</title>
<style>
${styles}
/* style for the print button */
#printBtn {
  display:inline-block;
  padding:10px 15px;
  margin:10px 0;
  background:teal;
  color:#fff;
  border:none;
  cursor:pointer;
  font-size:16px;
}
</style>
</head>
<body>

${clone.outerHTML}
</body>
</html>`;

    // 4️⃣ Download
    const blob = new Blob([htmlContent], { type: "text/html" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    const filename = document.getElementById("r_name").textContent.trim().replace(/\s+/g, '_').toLowerCase() || "relationship_analysis";
    a.href = url;
    a.download = `${filename}.html`;   // no extra quotes, correct interpolation
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });

  // Convert an image URL to a compressed JPEG base64 string
  async function toCompressedDataURL(url, quality = 0.7) {
    return new Promise((resolve, reject) => {
      const img = new Image();
      img.crossOrigin = "anonymous";
      img.onload = function () {
        const canvas = document.createElement("canvas");
        canvas.width = img.width;
        canvas.height = img.height;
        const ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0);
        // JPEG at given quality
        const dataUrl = canvas.toDataURL("image/jpeg", quality);
        resolve(dataUrl);
      };
      img.onerror = reject;
      img.src = url;
    });
  }
});
</script>



   
  
</body>
</html>